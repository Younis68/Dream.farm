<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dream Farm | ğŸ’ Luxury Booking</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />

    <style>
        /* --- Styles --- */
        :root {
            --primary-gold: #D4AF37;
            --primary-dark: #0f2e20; 
            --text-dark: #1a1a1a;
            --bg-body: #f4f7f6;
            --white-glass: rgba(255, 255, 255, 0.95);
            --shadow-soft: 0 15px 40px rgba(0,0,0,0.08);
            --radius-lg: 24px;
            --font-main: 'Tajawal', sans-serif;
        }

        * { box-sizing: border-box; outline: none; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
        body { font-family: var(--font-main); background-color: var(--bg-body); color: var(--text-dark); overflow-x: hidden; }

        /* Loader */
        #loader { position: fixed; inset: 0; background: var(--primary-dark); z-index: 9999; display: flex; justify-content: center; align-items: center; flex-direction: column; transition: opacity 0.5s ease; }
        .loader-icon { font-size: 3rem; color: var(--primary-gold); animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }

        /* Header */
        header { background: linear-gradient(135deg, var(--primary-dark), #1a3c30); height: 320px; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; border-bottom-left-radius: 40px; border-bottom-right-radius: 40px; padding: 20px; position: relative; }
        header h1 { font-size: 3rem; color: white; margin: 0; font-weight: 800; }
        .brand-badge { background: rgba(255,255,255,0.1); padding: 8px 20px; border-radius: 50px; border: 1px solid rgba(255,255,255,0.2); color: var(--primary-gold); font-size: 0.9rem; margin-bottom: 15px; font-weight: 700; }

        /* Search */
        .search-wrapper { margin-top: -35px; padding: 0 20px; position: relative; z-index: 50; display: flex; justify-content: center; }
        .search-box { background: white; width: 100%; max-width: 700px; padding: 10px; border-radius: 50px; display: flex; align-items: center; box-shadow: var(--shadow-soft); }
        .search-box i { padding: 0 20px; color: var(--primary-gold); }
        .search-box input { width: 100%; border: none; font-size: 1rem; padding: 12px 0; font-family: inherit; }

        /* Settings Menu */
        .settings-btn { position: absolute; top: 25px; right: 25px; background: rgba(255, 255, 255, 0.1); color: white; width: 50px; height: 50px; border-radius: 50%; font-size: 1.3rem; cursor: pointer; display: flex; align-items: center; justify-content: center; z-index: 100; }
        .settings-dropdown { display: none; position: absolute; top: 85px; right: 25px; background: var(--white-glass); backdrop-filter: blur(10px); width: 280px; border-radius: var(--radius-lg); box-shadow: 0 20px 50px rgba(0,0,0,0.15); z-index: 101; padding: 10px; }
        .settings-dropdown a, .notes-toggle-btn { display: flex; align-items: center; gap: 12px; padding: 14px; color: var(--primary-dark); text-decoration: none; width: 100%; border: none; background: transparent; cursor: pointer; font-family: inherit; font-weight: 600; font-size: 1rem; text-align: right; }
        .settings-dropdown a:hover, .notes-toggle-btn:hover { background: rgba(212, 175, 55, 0.1); color: var(--primary-gold); border-radius: 10px; }

        /* Cards & Swiper Fix */
        .container { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 35px; max-width: 1200px; margin: 40px auto 100px; padding: 0 20px; }
        .farm-card { background: white; border-radius: var(--radius-lg); overflow: hidden; box-shadow: var(--shadow-soft); position: relative; display: flex; flex-direction: column; }
        
        /* Swiper Styles */
        .swiper { width: 100%; height: 250px; /* Fixed Height Ø¨Û† ÙˆÛÙ†Û•ÛŒØ§Ù† */ background: #eee; }
        .swiper-slide img { width: 100%; height: 100%; object-fit: cover; }
        .swiper-pagination-bullet-active { background: var(--primary-gold) !important; }
        .swiper-button-next, .swiper-button-prev { color: white !important; transform: scale(0.6); text-shadow: 0 2px 5px rgba(0,0,0,0.5); }

        .card-content { padding: 25px; flex-grow: 1; display: flex; flex-direction: column; }
        .card-title-row { display: flex; justify-content: space-between; margin-bottom: 10px; }
        .amenities-list { margin: 15px 0; font-size: 0.9rem; color: #5a5a5a; display: flex; flex-wrap: wrap; gap: 10px; }
        .amenity-item { background: #f8f9fa; padding: 5px 10px; border-radius: 8px; }
        .price-wrapper { margin-top: auto; padding-top: 15px; border-top: 1px solid #f0f0f0; display: flex; justify-content: space-between; align-items: center; }
        .book-btn { background: var(--primary-dark); color: white; border: none; padding: 12px 25px; border-radius: 12px; cursor: pointer; font-weight: 700; }

        /* Socials */
        .social-dock { position: fixed; bottom: 30px; left: 30px; display: flex; flex-direction: column-reverse; gap: 15px; z-index: 90; }
        .social-bubble { width: 50px; height: 50px; border-radius: 50%; color: white; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; box-shadow: 0 4px 15px rgba(0,0,0,0.2); text-decoration: none; }
        .wa { background: #25D366; } .tk { background: #000; } .fb { background: #1877F2; } .in { background: radial-gradient(circle at 30% 107%, #fdf497 0%, #fd5949 45%, #d6249f 60%, #285AEB 90%); }

        /* Modal Styles */
        .modal-overlay { display: none; position: fixed; inset: 0; background: rgba(15, 46, 32, 0.6); backdrop-filter: blur(8px); z-index: 2000; justify-content: center; align-items: center; }
        .modal-box { background: white; width: 90%; max-width: 480px; border-radius: 24px; padding: 30px; position: relative; max-height: 90vh; overflow-y: auto; box-shadow: 0 25px 50px rgba(0,0,0,0.3); }
        .modal-active { display: flex; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from{opacity:0;} to{opacity:1;} }
        .close-modal { position: absolute; left: 20px; top: 20px; font-size: 1.5rem; color: #ccc; cursor: pointer; }

        /* Welcome Modal */
        #welcome-modal { position: fixed; inset: 0; background: rgba(15, 46, 32, 0.98); backdrop-filter: blur(10px); z-index: 9500; display: flex; justify-content: center; align-items: center; opacity: 0; pointer-events: none; transition: 0.5s; }
        #welcome-modal.active { opacity: 1; pointer-events: all; }
        .welcome-box { background: white; width: 90%; max-width: 500px; padding: 30px; border-radius: 20px; text-align: center; border: 2px solid var(--primary-gold); transform: scale(0.8); transition: 0.4s; }
        #welcome-modal.active .welcome-box { transform: scale(1); }
        .welcome-list { text-align: right; list-style: none; padding: 0; margin: 20px 0; background: #f9f9f9; padding: 15px; border-radius: 12px; }
        .welcome-list li { margin-bottom: 10px; font-size: 0.95rem; color: #555; display: flex; gap: 8px; align-items: center; }
        .welcome-btn { background: linear-gradient(135deg, var(--primary-dark), #1a3c30); color: white; width: 100%; padding: 15px; border: none; border-radius: 12px; font-size: 1.1rem; font-weight: bold; cursor: pointer; transition: 0.3s; }

        .form-group input, .form-group select { width: 100%; padding: 14px; border: 2px solid #eee; border-radius: 12px; margin-bottom: 20px; font-family: inherit; }
        .submit-wa { width: 100%; padding: 16px; border: none; border-radius: 12px; background: linear-gradient(135deg, #25D366, #128C7E); color: white; font-weight: 700; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; }
        
        /* Terms Modal List */
        .terms-list { list-style: none; margin-top: 15px; padding: 0; }
        .terms-list li { background: #fdfbf7; border-right: 3px solid var(--primary-gold); margin-bottom: 12px; padding: 12px; border-radius: 6px; font-size: 0.95rem; color: #444; line-height: 1.6; display: flex; gap: 10px; align-items: center; text-align: right; }
        .terms-list li i { color: var(--primary-gold); flex-shrink: 0; }
    </style>
</head>
<body>

    <div id="loader"><i class="fas fa-gem loader-icon"></i></div>

    <div id="welcome-modal">
        <div class="welcome-box">
            <i class="fas fa-file-contract" style="font-size:3rem; color:var(--primary-gold); margin-bottom:15px;"></i>
            <h2 style="color:var(--primary-dark); margin-bottom:10px;">Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Dream Farm</h2>
            <p style="color:#666;">ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙˆØ· Ù‚Ø¨Ù„ Ø§Ù„ØªØµÙØ­:</p>
            <ul class="welcome-list">
                <li><i class="fas fa-check-circle" style="color:var(--primary-gold)"></i> Ø§Ù„Ø­Ø¬Ø² ÙŠØ«Ø¨Øª ÙÙ‚Ø· Ø¨Ø¯ÙØ¹ Ø§Ù„Ø¹Ø±Ø¨ÙˆÙ†.</li>
                <li><i class="fas fa-check-circle" style="color:var(--primary-gold)"></i> Ø§Ù„Ø£Ø³Ø¹Ø§Ø± ØªØ®ØªÙ„Ù ÙÙŠ Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ø·Ù„.</li>
                <li><i class="fas fa-check-circle" style="color:var(--primary-gold)"></i> ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ù†Ø¸Ø§ÙØ© Ø§Ù„Ù…ÙƒØ§Ù†.</li>
            </ul>
            <button class="welcome-btn" onclick="acceptTerms()">Ù…ÙˆØ§ÙÙ‚ØŒ Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØµÙØ­</button>
        </div>
    </div>

    <header>
        <span class="brand-badge">Premium Rentals</span>
        <div class="settings-btn" onclick="toggleSettings()"><i class="fas fa-bars"></i></div>
        <div class="settings-dropdown" id="settingsDropdown">
            <a href="https://wa.me/9647502679528?text=Ø§Ù„Ø³Ù„Ø§Ù… Ø¹Ù„ÙŠÙƒÙ…ØŒ Ø£Ø±ÙŠØ¯ Ø¥Ø¶Ø§ÙØ© Ù…Ø²Ø±Ø¹ØªÙŠ" target="_blank" style="color:#25D366;"><i class="fas fa-plus-circle"></i> Ø£Ø¶Ù Ù…Ø²Ø±Ø¹ØªÙƒ Ù…Ø¹Ù†Ø§</a>
            <button class="notes-toggle-btn" onclick="openDetailedTerms()"><i class="fas fa-file-contract"></i> Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª</button>
        </div>
        <h1>Dream Farm</h1>
        <p>ØªØ¬Ø±Ø¨Ø© Ø§Ø³ØªØ«Ù†Ø§Ø¦ÙŠØ© Ù„Ø£Ø¬Ù…Ù„ Ø§Ù„Ù…Ø²Ø§Ø±Ø¹ ÙÙŠ Ø§Ù„Ø¹Ø±Ø§Ù‚</p>
    </header>

    <div class="search-wrapper">
        <div class="search-box">
            <i class="fas fa-search"></i>
            <input type="text" id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ø³Ù… Ø§Ù„Ù…Ø²Ø±Ø¹Ø©...">
        </div>
    </div>

    <div class="container" id="farm-list-container"></div>

    <div class="social-dock">
        <a href="#" class="social-bubble fb"><i class="fab fa-facebook-f"></i></a>
        <a href="#" class="social-bubble in"><i class="fab fa-instagram"></i></a>
        <a href="https://www.tiktok.com/@dream.farm68" class="social-bubble tk"><i class="fab fa-tiktok"></i></a>
    </div>

    <div id="terms-modal" class="modal-overlay">
        <div class="modal-box">
            <span class="close-modal" onclick="closeTermsModal()">&times;</span>
            <h2 style="text-align:center; color:var(--primary-dark); margin-bottom:20px;">ğŸ“œ Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª</h2>
            <ul class="terms-list">
                <li><i class="fas fa-money-bill-wave"></i> Ø§Ù„Ø­Ø¬Ø² Ù„Ø§ ÙŠØ¹ØªØ¨Ø± Ù…Ø¤ÙƒØ¯Ø§Ù‹ Ø¥Ù„Ø§ Ø¨Ø¹Ø¯ Ø¯ÙØ¹ Ø§Ù„Ø¹Ø±Ø¨ÙˆÙ† (Qi Card).</li>
                <li><i class="fas fa-clock"></i> ÙˆÙ‚Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø³Ø§Ø¹Ø© 2:00 Ø¸Ù‡Ø±Ø§Ù‹ØŒ ÙˆÙˆÙ‚Øª Ø§Ù„Ø®Ø±ÙˆØ¬ 11:00 ØµØ¨Ø§Ø­Ø§Ù‹.</li>
                <li><i class="fas fa-users"></i> ÙŠÙ…Ù†Ø¹ Ø¯Ø®ÙˆÙ„ Ø¹Ø¯Ø¯ Ø£Ø´Ø®Ø§Øµ Ø£ÙƒØ«Ø± Ù…Ù† Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØªÙÙ‚ Ø¹Ù„ÙŠÙ‡.</li>
                <li><i class="fas fa-broom"></i> ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø© Ø¹Ù„Ù‰ Ù†Ø¸Ø§ÙØ© Ø§Ù„Ù…ÙƒØ§Ù† ÙˆØ§Ù„Ø£Ø«Ø§Ø«ØŒ Ø£ÙŠ Ø¶Ø±Ø± ÙŠØªØ­Ù…Ù„Ù‡ Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø±.</li>
            </ul>
            <button onclick="closeTermsModal()" class="book-btn" style="width:100%; margin-top:20px; background:#ddd; color:#333;">Ø­Ø³Ù†Ø§Ù‹ØŒ ÙÙ‡Ù…Øª</button>
        </div>
    </div>

    <div id="booking-modal" class="modal-overlay">
        <div class="modal-box">
            <span class="close-modal" onclick="closeModal()"><i class="fas fa-times"></i></span>
            <h3 style="text-align:center; margin-bottom:20px;">Ø­Ø¬Ø² <span id="modal-farm-name" style="color:var(--primary-gold)"></span></h3>
            <form id="booking-form">
                <input type="hidden" id="farm-id-modal">
                <div class="form-group"><label>Ø§Ù„Ø§Ø³Ù…</label><input type="text" id="name" required placeholder="Ù†Ø§Ú¤Û Ø³ÛŒØ§Ù†ÛŒ"></div>
                <div class="form-group"><label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø¬Ø²</label><input type="date" id="date" required onchange="checkPrice()"></div>
                <div id="price-calc-area" style="text-align:center; padding:10px; background:#f9f9f9; border-radius:10px; margin-bottom:15px; display:none;"></div>
                <div class="form-group" style="display:flex; gap:10px;">
                    <input type="number" id="guests" placeholder="Ø§Ù„Ø¹Ø¯Ø¯" required>
                    <select id="type" required></select>
                </div>
                <button type="submit" id="submit-btn" class="submit-wa"><i class="fab fa-whatsapp"></i> Ø¥Ø±Ø³Ø§Ù„ ÙˆØ§ØªØ³Ø§Ø¨</button>
            </form>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

    <script>
        // Data
        const farmsData = [
            { id: 1, name: "Ù…Ø²Ø±Ø¹Ø© Ø§Ù„Ù‚ØµØ± Ø§Ù„Ø°Ù‡Ø¨ÙŠ", location: "Ø¯Û†Ú©Ø§Ù†ØŒ Ù‚Ø±Ø¨ Ø§Ù„Ø³Ø¯", images: ["https://images.unsplash.com/photo-1613490493576-7fde63acd811?w=800", "https://images.unsplash.com/photo-1566073771259-6a8506099945?w=800"], features: ["Ù…Ø³Ø¨Ø­ Ù…Ø¯ÙØ£", "Ø³ÙŠÙ†Ù…Ø§ Ø®Ø§Ø±Ø¬ÙŠØ©", "Ù…ÙˆÙ„Ø¯Ø© 24h"], bookedDates: ["2025-12-24"], allowedType: "family", pricing: { default: "150,000", weekDays: { 5: "200,000" } } },
            { id: 2, name: "ÙÙŠÙ„Ø§ Ø§Ù„Ø¬Ø¨Ù„", location: "Ø¬Ø¨Ù„ Ø§Ø²Ù…Ø±", images: ["https://images.unsplash.com/photo-1518780664697-55e3ad937233?w=800", "https://images.unsplash.com/photo-1510798831971-661eb04b3739?w=800"], features: ["Ø¥Ø·Ù„Ø§Ù„Ø© Ø¨Ø§Ù†ÙˆØ±Ø§Ù…Ø§", "Ø³Ø§Ø­Ø© Ø´ÙˆØ§Ø¡", "Ù…ÙˆÙ‚Ø¯ Ø­Ø·Ø¨"], bookedDates: [], allowedType: "all", pricing: { default: "75,000", weekDays: { 5: "100,000" } } },
            { id: 3, name: "ÙƒÙˆØ® Ø§Ù„ØºØ§Ø¨Ø©", location: "Ø´Ø§Ø±Ø¨ÛÚ˜ÛØ±", images: ["https://images.unsplash.com/photo-1542718610-a1d656d1884c?w=800"], features: ["ØªØµÙ…ÙŠÙ… Ø®Ø´Ø¨ÙŠ", "Ø®ØµÙˆØµÙŠØ© ØªØ§Ù…Ø©", "Ù†Ù‡Ø± Ù‚Ø±ÙŠØ¨"], bookedDates: [], allowedType: "youth", pricing: { default: "50,000", weekDays: { 5: "75,000" } } },
            { id: 4, name: "Ù…Ø²Ø±Ø¹Ø© Ø§Ù„Ù†Ø®ÙŠÙ„ VIP", location: "Ø¨ØºØ¯Ø§Ø¯ØŒ Ø§Ù„Ø¯ÙˆØ±Ø©", images: ["https://images.unsplash.com/photo-1564013799919-ab600027ffc6?w=800"], features: ["Ù‚Ø§Ø¹Ø© Ù…Ù†Ø§Ø³Ø¨Ø§Øª", "Ù…Ø³Ø¨Ø­ Ø£ÙˆÙ„Ù…Ø¨ÙŠ", "Ù…Ù„Ø¹Ø¨ ÙƒØ±Ø©"], bookedDates: [], allowedType: "family", pricing: { default: "200,000", weekDays: { 5: "250,000" } } }
        ];

        const container = document.getElementById('farm-list-container');

        // 1. Startup Logic
        window.addEventListener('load', () => { 
            setTimeout(() => { 
                document.getElementById('loader').style.opacity = '0'; 
                setTimeout(() => {
                    document.getElementById('loader').style.display = 'none';
                    document.getElementById('welcome-modal').classList.add('active');
                }, 500); 
            }, 1500); 
        });

        window.acceptTerms = function() { document.getElementById('welcome-modal').classList.remove('active'); }
        window.toggleSettings = function() { const m = document.getElementById('settingsDropdown'); m.style.display = (m.style.display === 'block') ? 'none' : 'block'; }
        window.openDetailedTerms = function() { document.getElementById('settingsDropdown').style.display = 'none'; document.getElementById('terms-modal').classList.add('modal-active'); }
        window.closeTermsModal = function() { document.getElementById('terms-modal').classList.remove('modal-active'); }

        // 2. Render Farms with Swiper (Fixed Logic)
        function renderFarms(list) {
            container.innerHTML = "";
            if (list.length === 0) { container.innerHTML = `<div style="text-align:center;grid-column:1/-1;padding:50px;color:#999;"><h3>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬! ğŸ§</h3></div>`; return; }

            list.forEach(farm => {
                let badge = farm.allowedType === 'family' ? '<span style="background:#e91e63;color:white;padding:5px 10px;border-radius:20px;font-size:0.7rem">Ø¹Ø§Ø¦Ù„Ø§Øª</span>' : 
                            farm.allowedType === 'youth' ? '<span style="background:#9c27b0;color:white;padding:5px 10px;border-radius:20px;font-size:0.7rem">Ø´Ø¨Ø§Ø¨</span>' : 
                            '<span style="background:#009688;color:white;padding:5px 10px;border-radius:20px;font-size:0.7rem">Ù…Ø®ØªÙ„Ø·</span>';

                // Swiper Slides HTML
                const slides = farm.images.map(img => `
                    <div class="swiper-slide">
                        <img src="${img}" alt="${farm.name}" loading="lazy">
                    </div>
                `).join('');

                container.innerHTML += `
                <div class="farm-card">
                    <button class="share-btn" onclick="shareFarm('${farm.name}')" style="position:absolute;top:15px;left:15px;z-index:20;background:white;border:none;width:35px;height:35px;border-radius:50%;cursor:pointer;box-shadow:0 2px 5px rgba(0,0,0,0.2)"><i class="fas fa-share-alt"></i></button>
                    
                    <div class="swiper mySwiper-${farm.id}">
                        <div class="swiper-wrapper">
                            ${slides}
                        </div>
                        <div class="swiper-pagination"></div>
                        <div class="swiper-button-next"></div>
                        <div class="swiper-button-prev"></div>
                    </div>

                    <div class="card-content">
                        <div class="card-title-row"><h3>${farm.name}</h3>${badge}</div>
                        <div style="font-size:0.9rem; color:#666; margin-bottom:10px;"><i class="fas fa-map-marker-alt" style="color:var(--primary-gold)"></i> ${farm.location}</div>
                        <div class="amenities-list">${farm.features.map(f => `<div class="amenity-item"><i class="fas fa-star" style="color:var(--primary-gold)"></i> ${f}</div>`).join('')}</div>
                        <div class="price-wrapper">
                            <div><div class="price-val">${farm.pricing.default} <small>Ø¯.Ø¹</small></div><div style="font-size:0.8rem;color:#999">Ø³Ø¹Ø± Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ø§Ø¯ÙŠØ©</div></div>
                            <button class="book-btn" onclick="openModal(${farm.id})">Ø§Ø­Ø¬Ø² Ø§Ù„Ø¢Ù†</button>
                        </div>
                    </div>
                </div>`;
            });

            // Initialize Swiper for each card
            list.forEach(farm => {
                new Swiper(`.mySwiper-${farm.id}`, {
                    pagination: { el: ".swiper-pagination", dynamicBullets: true },
                    navigation: { nextEl: ".swiper-button-next", prevEl: ".swiper-button-prev" },
                    loop: true,
                    grabCursor: true
                });
            });
        }

        document.getElementById('searchInput').addEventListener('keyup', (e) => {
            const val = e.target.value.toLowerCase();
            renderFarms(farmsData.filter(f => f.name.includes(val) || f.location.includes(val)));
        });

        const modal = document.getElementById('booking-modal');
        const dateInput = document.getElementById('date');
        const priceArea = document.getElementById('price-calc-area');
        const submitBtn = document.getElementById('submit-btn');
        let currentFarm = null;

        window.openModal = function(id) {
            currentFarm = farmsData.find(f => f.id === id);
            document.getElementById('modal-farm-name').textContent = currentFarm.name;
            document.getElementById('farm-id-modal').value = id;
            dateInput.min = new Date().toISOString().split('T')[0];
            dateInput.value = ''; priceArea.style.display = 'none'; submitBtn.disabled = true;
            const typeSel = document.getElementById('type'); typeSel.innerHTML = '';
            if(currentFarm.allowedType === 'family') typeSel.innerHTML = '<option>Ø¹Ø§Ø¦Ù„Ø§Øª (Family)</option>';
            else if(currentFarm.allowedType === 'youth') typeSel.innerHTML = '<option>Ø´Ø¨Ø§Ø¨ (Youth)</option>';
            else typeSel.innerHTML = '<option>Ø¹Ø§Ø¦Ù„Ø§Øª (Family)</option><option>Ø´Ø¨Ø§Ø¨ (Youth)</option>';
            modal.classList.add('modal-active');
        }
        window.closeModal = function() { modal.classList.remove('modal-active'); }

        // 3. Fixed Date & Price Logic
        window.checkPrice = function() {
            if(!dateInput.value || !currentFarm) return;
            
            // Ú†Ø§Ø±Û•Ø³Û•Ø±ÛŒØ§ Ø¨Û•Ø±ÙˆØ§Ø±ÛŒ: Ø²ÛØ¯Û•Ú©Ø±Ù†Ø§ Ú©Ø§ØªÛ T00:00:00 Ø¨Û† Ú•Ø§Ø³ØªÚ©Ø±Ø¯Ù†Û•ÙˆÛ•ÛŒ Ú•Û†Ú˜ÛŒ
            const dStr = dateInput.value; 
            const dObj = new Date(dStr + 'T00:00:00'); 
            const day = dObj.getDay(); // 5 = Friday

            if(currentFarm.bookedDates.includes(dStr)) { 
                priceArea.innerHTML = `<span style="color:red;font-weight:bold;">â›” Ù…Ø­Ø¬ÙˆØ²</span>`; 
                priceArea.style.display='block'; 
                submitBtn.disabled=true; 
                return; 
            }

            let p = currentFarm.pricing.default; let n = "Ø³Ø¹Ø± Ø¹Ø§Ø¯ÙŠ";
            // Check for Friday (Day 5)
            if(currentFarm.pricing.weekDays[day]) { 
                p = currentFarm.pricing.weekDays[day]; 
                n = "Ø³Ø¹Ø± Ø¹Ø·Ù„Ø© (Ø§Ù„Ø¬Ù…Ø¹Ø©) ğŸ”¥"; 
            }
            
            priceArea.style.display = 'block'; 
            priceArea.innerHTML = `<div style="color:green;font-weight:bold;">${p} Ø¯.Ø¹</div><small>${n}</small>`; 
            submitBtn.disabled = false;
        }

        document.getElementById('booking-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const msg = `*Ø­Ø¬Ø² Ø¬Ø¯ÙŠØ¯ VIP* âœ¨\nğŸ¡ ${currentFarm.name}\nğŸ“… ${dateInput.value}\nğŸ‘¤ ${document.getElementById('name').value}\nğŸ‘¥ ${document.getElementById('guests').value}\nğŸ“‹ ${document.getElementById('type').value}`;
            window.open(`https://wa.me/9647502679528?text=${encodeURIComponent(msg)}`, '_blank');
            closeModal();
        });

        window.shareFarm = function(name) { if(navigator.share) navigator.share({title:'Dream Farm', text:name, url:window.location.href}); else alert("ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·"); }
        window.onclick = function(e) { if(e.target.classList.contains('modal-overlay')) e.target.classList.remove('modal-active'); }

        renderFarms(farmsData);
    </script>
</body>
</html>
